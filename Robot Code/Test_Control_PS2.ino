// นี่คือโค้ด Arduino สำหรับควบคุมมอเตอร์โดยใช้ PS2 คอนโทรลเลอร์

#include <PS2X_lib.h>  // สำหรับ v1.6
#define SPEED_1  80
#define SPEED_2  160
#define SPEED_3  200
#define SPEED_4  250

PS2X ps2x; // สร้างคลาส PS2 Controller

// ... (คอนฟิกอุปกรณ์และตัวแปรอื่น ๆ ต่อจากนี้)

void setup()
{
  // ... (ค่าการตั้งค่าและการกำหนด pinMode ต่อจากนี้)

  error = ps2x.config_gamepad(13, 11, 10, 12, true, true);   // กำหนดค่า controller และตรวจสอบข้อผิดพลาด

  // ... (ตรวจสอบข้อผิดพลาดและแสดงข้อความต่อจากนี้)

}

void loop()
{
    int pwm = readSerialValue();

    // ... (ควบคุมมอเตอร์ตามค่า pwm ต่อจากนี้)

    if(error == 1) // ข้ามการทำงานถ้าไม่พบคอนโทรลเลอร์
      return; 

    if(type == 2){ // คอนโทรลเลอร์ Guitar Hero
  
    }
    else { // คอนโทรลเลอร์ DualShock
  
      ps2x.read_gamepad(false, vibrate);  // อ่านคอนโทรลเลอร์และตั้งค่าการสั่นมอเตอร์

      // ... (ตรวจสอบปุ่มและอ่านค่าสเติร์กแอนะล็อกต่อจากนี้)

    }

    delay(50);

}

// ... (คำสั่งและฟังก์ชันอื่น ๆ ต่อจากนี้)

// เพิ่มคอมเมนต์เพิ่มเติมเช่น อธิบายการทำงานของฟังก์ชันเหล่านี้:

// void runForward(){
//   // ตรวจสอบและควบคุมการเคลื่อนที่ไปข้างหน้า
// }

// void runBackward(){
//   // ตรวจสอบและควบคุมการเคลื่อนที่ถอยหลัง
// }

// ... (อธิบายการทำงานของฟังก์ชันอื่น ๆ ต่อจากนี้)

